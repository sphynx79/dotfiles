# vim: set sw=4 ts=4 sts=4 et tw=120 foldmarker={{{,}}} foldmethod=marker nospell:

# VARIABLES {{{

    # $scrPath=$HOME/.local/lib/hyde # set scripts path
    $scrPath=$HOME/.config/hypr/bin # set scripts path
    # Set your personal hyprland configuration here

    # Main modifier
    $mainMod = SUPER # windows key

    # Assign apps
    $TERMINAL = kitty
    $EDITOR = nvim
    $EXPLORER = krusader
    $BROWSER = vivaldi
    $LOCKSCREEN= hyprlock

    # // █▀▀ ▀█▀ █▄▀
    # // █▄█ ░█░ █░█
    $GTK_THEME=Nordic-Blue
    $ICON_THEME=Papirus-Dark
    $COLOR_SCHEME=prefer-dark

    # // █▀▀ █░█ █▀█ █▀ █▀█ █▀█
    # // █▄▄ █▄█ █▀▄ ▄█ █▄█ █▀▄
    $CURSOR_THEME=nitrux_snow_cursors
    $CURSOR_SIZE=28

    # // █▀▀ █▀█ █▄░█ ▀█▀
    # // █▀░ █▄█ █░▀█ ░█░
    $FONT=Cantarell
    $FONT_STYLE=Regular
    $FONT_SIZE=10
    $DOCUMENT_FONT=Cantarell
    $DOCUMENT_FONT_SIZE=10
    $MONOSPACE_FONT=CaskaydiaCove Nerd Font Mono
    $MONOSPACE_FONT_SIZE=9
    $NOTIFICATION_FONT=Mononoki Nerd Font Mono
    $BAR_FONT=JetBrainsMono Nerd Font
    $MENU_FONT=JetBrainsMono Nerd Font #? Use the same font as the main font
    $FONT_ANTIALIASING=rgba
    $FONT_HINTING=slight

    $active = 0.94
    $inactive = 0.82
# }}}

# SOURCE {{{
    # TODO: vedere dove mettere questa parte per avere priorita sui temi
    # TODO: Eliminare la gestione di wallbash
    source = $XDG_CONFIG_HOME/hypr/themes/colors.conf # Hyde wallbash colors


    # TODO: vedere quali di questa lasciare
    # source = $XDG_CONFIG_HOME/hypr/themes/theme.conf # theme specific settings
    # source = $XDG_CONFIG_HOME/hypr/themes/wallbash.conf # Theme specific settings after Sanitize and handle fallbacks
    # source = $XDG_CONFIG_HOME/hypr/nvidia.conf # Nvidia specific settings
    # source = $XDG_CONFIG_HOME/hypr/animations.conf # source animations variables
    source = $XDG_CONFIG_HOME/hypr/shaders.conf # source shader variables
    # source = $XDG_CONFIG_HOME/hypr/hyde.conf
    # TODO: vedere se lasciarlo
    # source = $XDG_STATE_HOME/hyde/hyprland.conf # translated from config.toml // should override everything!
    # TODO: vedere come vengono gestiti i shader
    decoration:screen_shader = $XDG_CONFIG_HOME/hypr/shaders/.compiled.cache.glsl #! This is the compiled shader file, it will be created by the shaders.sh script
# }}}

# ENV {{{
    # XDG Specifications - https://wiki.hyprland.org/Configuring/Environment-variables/#xdg-specifications
    env = XDG_CURRENT_DESKTOP,Hyprland
    env = XDG_SESSION_TYPE,wayland
    env = XDG_SESSION_DESKTOP,Hyprland

    # Qt Variables  - https://wiki.hyprland.org/Configuring/Environment-variables/#qt-variables
    env = QT_AUTO_SCREEN_SCALE_FACTOR,1 # (From the Qt documentation) enables automatic scaling, based on the monitor’s pixel density
    env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1  # Disables window decorations on Qt applications
    env = QT_QPA_PLATFORMTHEME,qt6ct # Tells Qt based applications to pick your theme from qt5ct, use with Kvantum.

    # Toolkit Backend Variables - https://wiki.hyprland.org/Configuring/Environment-variables/#toolkit-backend-variables
    env = GDK_BACKEND,wayland,x11,* # GTK: Use wayland if available. If not: try x11, then any other GDK backend.
    env = QT_QPA_PLATFORM,wayland;xcb  # Tell Qt applications to use the Wayland backend, and fall back to x11 if Wayland is unavailable
    env = SDL_VIDEODRIVER,wayland # Run SDL2 applications on Wayland. Remove or set to x11 if games that provide older versions of SDL cause compatibility issues
    env = CLUTTER_BACKEND,wayland # Clutter package already has wayland enabled, this variable will force Clutter applications to try and use the Wayland backend

    # Wayland-ENV
    env = MOZ_ENABLE_WAYLAND,1
    env = GDK_SCALE,1 # Set GDK scale to 1 // For Xwayland on HiDPI
    env = ELECTRON_OZONE_PLATFORM_HINT,auto  # Set Electron Ozone Platform Hint to auto // For Electron apps on Wayland

    env = __GLX_VENDOR_LIBRARY_NAME,nvidia # Disable this if you have issues with screensharing
    env = GBM_BACKEND,nvidia-drm
    env = EGL_PLATFORM,wayland
    env = NVD_BACKEND,direct
    env = PROTON_ENABLE_NGX_UPDATER,1
    env = LIBVA_DRIVER_NAME,nvidia
    env = __GL_GSYNC_ALLOWED,1
    env = __GL_MaxFramesAllowed,1
    env = __GL_VRR_ALLOWED,1
    env = GDK_DPI_SCALE,0.9
    env = SCALE_FACTOR,1
    env = ELECTRON_SCALE_FACTOR,1
    env = ELECTRON_FORCE_DEVICE_SCALE_FACTOR,1
    env = _JAVA_OPTIONS,-Dsun.java2d.uiScale=1 -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
    #env =  AQ_NO_MODIFIERS,1
    #env = __NV_DISABLE_EXPLICIT_SYNC,1

    # XDG-ENV
    env = XDG_RUNTIME_DIR,$XDG_RUNTIME_DIR
    env = XDG_CONFIG_HOME,$HOME/.config
    env = XDG_CACHE_HOME,$HOME/.cache
    env = XDG_DATA_HOME,$HOME/.local/share
    env = XDG_STATE_HOME,$HOME/.local/state

    # HyDE Variables
    env = PATH,$HOME/.local/bin:$scrPath:$env.PATH:$PATH

    # Setting GTK
    # Create a dconf file that will be loaded later one time, better than multiple dconf commands and better than gsettings
    # TODO: ho messo valori fissi, ma vedererlo come mettere e gestirlo con una cartella theme
    # e poi fare il source della cartella theme
    $dconFile=$env.XDG_CACHE_HOME/hyde/dconf
    $dConf = \n[org/gnome/desktop/interface]\n
    $dConf = $dConf icon-theme='Papirus-Dark'\n
    $dConf = $dConf gtk-theme='Nordic-Blue'\n
    $dConf = $dConf color-scheme='prefer-dark'\n
    $dConf = $dConf cursor-theme='Bibata-Modern-Ice'\n
    $dConf = $dConf cursor-size=24\n
    $dConf = $dConf font-name='Cantarell 10'\n
    $dConf = $dConf document-font-name='Cantarell 10'\n
    $dConf = $dConf monospace-font-name='CaskaydiaCove Nerd Font Mono 9'\n
    $dConf = $dConf font-antialiasing='rgba'\n
    $dConf = $dConf font-hinting='slight'\n
    $dConf = $dConf [org/gnome/desktop/default-applications/terminal]\nexec='kitty'
    $dConf = $dConf \n[org/gnome/desktop/wm/preferences]\nbutton-layout=''\n
    $dconf.preserve =  dconf dump / > $dconFile
    $dconf.populate =  printf "$dConf" >> $dconFile
    $dconf.reset = dconf reset -f / < $dconFile #! Use this as dconf update won't refresh when key-val is the same
    $dconf.load = dconf load -f / < $dconFile
    # $dconf.update = dconf update
    $set.hyprCursor = hyprctl setcursor $CURSOR_THEME $CURSOR_SIZE
    # $exec.dConf = ( $dconf.populate && $dconf.load && $dconf.update && $set.hyprCursor )
    $exec.dConf = ( $dconf.preserve && $dconf.populate && $dconf.reset && $dconf.load && $set.hyprCursor )

    # Execute
    exec = $exec.dConf
# }}}

# LAUNCHER {{{
    $list.variables=WAYLAND_DISPLAY XDG_CURRENT_DESKTOP XDG_SESSION_TYPE XDG_SESSION_DESKTOP XDG_CONFIG_HOME QT_QPA_PLATFORMTHEME
    # Tipo di slice per uwsm
    # a: app-graphical.slice (predefinita) - Per le applicazioni grafiche generiche.
    # b: background-graphical.slice - Per le applicazioni grafiche in background.
    # s: session-graphical.slice - Per le applicazioni che sono considerate parte integrante della sessione stessa
    exec-once = $scrPath/resetxdgportal.sh                                           # reset XDPH for screenshare
    exec-once = dbus-update-activation-environment --systemd --all                   #? Might fail so we hardcode the variables below
    exec-once = dbus-update-activation-environment --systemd  $list.variables        # for XDPH
    exec-once = systemctl --user import-environment $list.variables # for XDPH ( redundant with the first one )
    exec-once = app2unit.sh -t service $scrPath/polkitkdeauth  # authentication dialogue for GUI apps
    exec-once = app2unit.sh -t service waybar   # launch the system bar
    # TODO: Ho provato a usare questo ma non funziona per cui lo ho semplifciato ma provare a usare qusto
    # exec-once = app2unit.sh -u hyde-$XDG_SESSION_DESKTOP-waybar-watcher.service -t service -- waybar.py --watch
    exec-once = app2unit.sh -t service blueman-applet # systray app for Bluetooth
    exec-once = app2unit.sh -t service udiskie --automount --smart-tray --ignore-device # front-end that allows to manage removable media
    # TODO: vedere se sostituirlo con dust, HYDE usa dust
    exec-once = app2unit.sh -t service swaync # start notification demon
    exec-once = app2unit.sh -t service nm-applet --indicator # systray app for Network/Wifi
    exec-once = app2unit.sh -t service wl-paste --type text --watch cliphist store # clipboard store text data
    exec-once = app2unit.sh -t service wl-paste --type image --watch cliphist store # clipboard store image data
    exec-once = app2unit.sh -t service wl-clip-persist --clipboard regular # wl-clip-persist (daemon)
    # TODO: Semplificare la gestione wallpaper
    exec-once = app2unit.sh -t service swaybg -i ~/.config/hypr/themes/current/background -m fill # start wallpaper daemon

    exec-once = app2unit.sh -t service hypridle # idle daemon
    exec-once = app2unit.sh -t service /home/ichelema/.asdf/shims/pypr

    exec-once = app2unit.sh -t service cairo-dock --wayland --opengl

    exec-once = hyprctl setcursor $CURSOR_THEME $CURSOR_SIZE #? Set cursor theme and size

    exec = $scrPath/keybinds.hint.py --format rofi > $XDG_RUNTIME_DIR/tmp/keybinds_hint.rofi

    exec-once = app2unit.sh -t service walker --gapplication-service
    exec-once = systemctl --user start elephant.service

    exec-once = kando

    # Questo script mi gestisce meglio quando utilizzo i gruppi per il workspace 1
    # con layout float, uso la parte centrale con i gruppi
    # e se ho una sola finestra non ragruppata usa tutta altezza
    # altrimenti piu bassa in altro di 18 px che e altezza della barra dei gruppi
    exec-once = app2unit.sh -t service $scrPath/hyprland_group_handler

    exec-once = app2unit.sh -t service jamesdsp --tray

# }}}

# GENERAL {{{
    general {
        layout = dwindle
        gaps_in = 2
        gaps_out = 4
        border_size = 2
        col.active_border = rgba(78c6ebff) rgba(8289a380) 45deg
        col.inactive_border = rgba(7d838d80) rgba(4c566a50) 45deg
        col.nogroup_border_active = rgba(78c6ebff) rgba(8289a380) 45deg
        col.nogroup_border = rgba(7d838d80) rgba(4c566a50) 45deg
        resize_on_border = true
        snap {
            enabled = true
            window_gap = 20
            monitor_gap = 20
            respect_gaps = true
        }
    }
# }}}

# GROUP {{{
    group {

        # Bborder color for active windows
        col.border_active = rgba(78c6ebff) rgba(8289a380) 45deg
        # Border color for inactive windows
        col.border_inactive = rgba(3C3C3Caa)
        auto_group = false
        # 1 Ragruppa quando faccio il drag sopra la finestra
        # 2 Ragruppa quando faccio il drag nella barra del gruppo
        drag_into_group = 2
        # Disabilita il group di un group in ultro group con trascnamento sulla finestra
        merge_groups_on_drag = false
        # Abilita il group di un group in ultro group con trascnamento nella barra del gruppo
        merge_groups_on_groupbar = true

        groupbar {
            enabled = true
            gradients = 1
            render_titles = 1
            blur = true
            font_family = Cantarell
            height = 18
            font_size = 11
            font_weight_inactive = normal
            font_weight_active = bold
            indicator_gap = 0
            indicator_height = 0
            rounding = 0
            keep_upper_gap = false
            scrolling = true
            gaps_out = 1
            gaps_in = 3

            # Nord Theme Colors
            col.active = rgba(434c5ee6) rgba(4c566ae6) 45deg
            col.inactive = rgba(4c566a80)
            col.locked_active = rgba(bf616aff)
            col.locked_inactive = rgba(5e81acaa)
            text_color = rgba(77ABCBCC)
            text_color_inactive = rgba(d8dee980)
        }
    }
# }}}

# MONITOR {{{
    monitorv2 {
        output = DP-1
        mode = 5120x1440@165
        position = 0x0
        scale = 1.25
        bitdepth = 10
        sdrbrightness = 1.0
        sdrsaturation = 1.0
        supports_wide_color = 1
        supports_hdr = 1
        sdr_min_luminance = 0.005
        sdr_max_luminance = 200
        min_luminance = 0.001
        max_luminance = 1000
        max_avg_luminance = 200
        cm = dcip3
    }
# }}}

# ANIMATIONS {{{
    animations {
        enabled = yes
        bezier = wind, 0.05, 0.9, 0.1, 1.05
        bezier = winIn, 0.1, 1.1, 0.1, 1.1
        bezier = winOut, 0.3, -0.3, 0, 1
        bezier = liner, 1, 1, 1, 1
        animation = windows, 1, 6, wind, slide
        animation = windowsIn, 1, 6, winIn, slide top
        animation = windowsOut, 1, 5, winOut, slide bottom
        animation = windowsMove, 1, 5, wind, slide
        animation = border, 1, 1, liner
        animation = borderangle, 1, 30, liner, once
        animation = fade, 1, 10, default
        animation = workspaces, 1, 5, wind
    }
# }}}

# DECORATIONS {{{
    decoration {
        rounding = 2
        dim_special = 0.3
        active_opacity = 0.94
        inactive_opacity = 0.82
        fullscreen_opacity = 1

        blur {
            enabled = yes
            special = true
            size = 8
            passes = 2
            new_optimizations = on
            ignore_opacity = true
            xray = false
            popups = true
            vibrancy = 0.5
            brightness = 0.80
        }

        shadow {
            enabled = false
        }
    }
# }}}

# INPUT {{{
    input {
        kb_layout = us
        kb_variant =
        follow_mouse = 2
        #follow_mouse_threshold = 500
        special_fallthrough = true
        focus_on_close = 1
        kb_options = compose:rctrl,fkeys:basic_13-24

        scroll_factor = 0.8
        accel_profile = custom
        scroll_points = 0.2144477506 0.000 0.307 0.615 1.077 1.539 2.002 2.505 3.208 3.910 4.613 5.315 6.018 6.720 7.423 8.125 8.828 9.530 10.233 10.935 12.387

        sensitivity = -0.3
        force_no_accel = false
        numlock_by_default = true
        repeat_rate = 40
        repeat_delay = 300

        touchpad {
            natural_scroll = no
        }
    }

    #See https://wiki.hypr.land/Configuring/Gestures/
    gesture = 3, horizontal, workspace
    gesture = 3, pinchin,float,tile
    gesture = 3, pinchout,float, float

# }}}

# CURSOR {{{
    cursor {
        use_cpu_buffer = true
        no_hardware_cursors = false
        no_warps = false
        persistent_warps = true
    }
# }}}

# LAYOUT {{{
    dwindle {
        pseudotile = true
        preserve_split = true
        force_split = 2
        smart_split = false
        use_active_for_splits = false
        default_split_ratio = 1.23606
        split_width_multiplier = 1.3
        single_window_aspect_ratio = 16 9
    }

    master {
        orientation = left
        # imposta la scala delle finestre speciali (le finestre speciali sono buone, dai un'occhiata . . .)
        # special_scale_factor = 2
        # mfact è la larghezza della finestra principale, o 'master factor'
        # mfact = 0.30
        new_status = slave
        new_on_active = right
    }

# }}}

# MISC {{{
    # TODO: ho messo i font fisso, ma vedererlo come mettere e gestirlo con una cartella theme
    misc {
        vrr = 3 # VRR only game and video fullscreen
        disable_hyprland_logo = true
        disable_splash_rendering = true
        force_default_wallpaper = 0
        font_family = Cantarell
        # focus_on_activate = true
        allow_session_lock_restore = true
        anr_missed_pings = 5
    }

    xwayland {
        force_zero_scaling = true
    }

    render {
        direct_scanout = true
    }

    # In sezione OpenGL
    #opengl {
    #    nvidia_anti_flicker = true  # riduce il flickering su nvidia
    #}
# }}}

# KEYBINDINGS {{{
    # Quake mode {{{
        $l=Quake
        $d=[$ls]
        bindd = Ctrl, grave, $d kitty, exec, pypr-client toggle term
        bindd = $mainMod, grave, $d obsidian, exec, pypr-client toggle obsidian
        bindd = Alt, grave, $d chat-gpt, exec, pypr-client toggle chat-gpt
        bindd = $mainMod SHIFT, grave, $d dolphin, exec, pypr-client toggle dolphin
    # }}}

    # Launcher {{{
        $l=Launchers
        $d=[$l|Apps]
        bindd = $mainMod Ctrl, T, $d terminal emulator , exec , app2unit.sh $TERMINAL -1 --instance-group kitty
        bindd = $mainMod Ctrl, E, $d file explorer , exec , app2unit.sh $EXPLORER
        bindd = $mainMod Ctrl, S, $d text editor , exec, app2unit.sh kitty -1 --instance-group $EDITOR --class kitty-$EDITOR -e $EDITOR
        bindd = $mainMod Ctrl, B, $d web browser , exec, app2unit.sh $BROWSER
        bindd = $mainMod Ctrl, M, $d system monitor , exec, kitty -1 --instance-group btop --class btop -e btop
        bindd = $mainMod Ctrl, O, $d octopi pacman gui , exec, /usr/bin/octopi
        bindd = $mainMod Ctrl, L, $d llm , exec, app2unit.sh ~/.local/bin/llmmenu

        # Special Key used with Nuphy Keyboard
        $d=[$l|Nuphy Keyboard]
        bindd = , F13, $d web browser , exec, app2unit.sh $BROWSER
        bindd = , F14, $d file explorer , exec, app2unit.sh $EXPLORER
        bindd = , F15, $d terminal emulator , exec, app2unit.sh $TERMINAL -1
        bindd = , F16, $d text editor , exec, app2unit.sh kitty -1 --instance-group $EDITOR --class kitty-$EDITOR -e $EDITOR
        bindd = , F17, $d octopi pacman gui , exec, /usr/bin/octopi
        bindd = , F18, $d system monitor , exec, kitty -1 --class btop -e btop
        bindd = , F19, $d llm , exec, app2unit.sh ~/.local/bin/llmmenu
        bindd = , F20, $d logout menu, exec, $scrPath/menu system #logout menu

        $d=[$l|Rofi menus]
        $rofi-launch=$scrPath/rofilaunch.sh
        # bindd = $mainMod, Space, $d application finder , exec, pkill -x rofi || $rofi-launch d
        bindd = $mainMod, TAB, $d window switcher , exec, pkill -x rofi || $rofi-launch w
        bindd = $mainMod Shift, E, $d file finder , exec, pkill -x rofi || $rofi-launch f
        # bindd = $mainMod, comma, $d emoji  picker , exec, pkill -x rofi || $scrPath/emoji-picker.sh # launch emoji picker
        bindd = $mainMod, period, $d glyph picker , exec, pkill -x rofi || $scrPath/glyph-picker.sh # launch glyph picker
        bindd = $mainMod, V, $d clipboard ,  exec, pkill -x rofi || $scrPath/cliphist.sh -c # launch clipboard,
        bindd = $mainMod Shift, V, $d clipboard manager , exec, pkill -x rofi || $scrPath/cliphist.sh # launch clipboard Manager
        bindd = $mainMod Alt, R, $d select rofi launcher , exec, pkill -x rofi || $scrPath/rofiselect.sh # launch select menu

    # }}}

    # Minimize {{{
        $mn=Minimize
        $d=[$mn]
        bindd = $mainMod, M, $d current window , exec, hyprland-minimizer

        # Restore the last minimized window
        bindd = $mainMod SHIFT, M, $d restore last , exec, hyprland-minimizer --restore-last

        # Interactively select a window to restore
        bindd = $mainMod Shift Control, M, $d interactive restore menu , exec, hyprland-minimizer --menu

        # Move/Switch to special workspace (scratchpad)
        #$d=[$mn|Special workspace]
        #bindd = $mainMod SHIFT, M, $d toggle scratchpad , togglespecialworkspace, special
        #bindd = $mainMod, M, $d move to scratchpad (silent) , exec, pypr-client toggle_special special
        #sbindd = $mainMod Alt, M, $d move to scratchpad  d (silent) , movetoworkspacesilent, special
    # }}}`

    # Window Management {{{
        $wm=Window Management
        $d=[$wm]
        bindd = $mainMod, Q, $d close focused window, exec, $scrPath/dontkillsteam
        # bindd = $mainMod, Delete, $d kill hyprland session, exit
        bindd = $mainMod, W, $d Toggle floating,  exec, hyprctl --batch "dispatch togglefloating; dispatch resizeactive exact 35% 95%; dispatch centerwindow"
        bindd = Shift, F11, $d toggle fullscreen, fullscreen
        bindd = $mainMod Shift, F, $d toggle pin on focused window, exec, $scrPath/windowpin.sh
        bindd = $mainMod, E, $d toggle pin on focused window, exec, hyprctl dispatch tagwindow pinned && hyprctl dispatch pin
        bindd = $mainMod, S, $d toggle split, togglesplit

        $d=[$wm|Group Navigation]
        bindd = $mainMod Alt, Right, $d go app right , exec, hyprctl -q dispatch changegroupactive f
        bindd = $mainMod Alt, Left, $d go app left , exec, hyprctl -q dispatch changegroupactive b
        bindd = $mainMod, G, $d Enter group mode, submap, group
        # Define submap "group"
        submap = group, reset
        # Inside submap group
        bindde = , right, $d go app right , exec, hyprctl -q dispatch changegroupactive f
        bindde = , left, $d go app left, exec, hyprctl -q dispatch changegroupactive b
        bindde = , h, $d move right , exec, hyprctl -q dispatch movegroupwindow f
        bindde = , l, $d move left, exec, hyprctl -q dispatch movegroupwindow bEsegui Comando
        bindde = , t, $d Toggle group, exec, hyprctl -q dispatch togglegroup
        bindd = , escape, $d exit group mode, submap, reset
        bindd = , return, $d exit group mode, submap, reset
        # Come back global mode
        submap = reset

        $d=[$wm|Change focus]
        bindd = $mainMod, Left, $d focus left, movefocus, l
        bindd = $mainMod, Right, $d focus right , movefocus, r
        bindd = $mainMod, Up, $d focus up , movefocus, u
        bindd = $mainMod, Down , $d focus down, movefocus, d

        $d=[$wm|Move active window across current workspace]
        $moveactivewindow=grep -q "true" <<< $(hyprctl activewindow -j | jq -r .floating) && hyprctl dispatch moveactive
        bindde = $mainMod Shift Control, left, Move active window to the left, exec, $moveactivewindow -30 0 || hyprctl dispatch movewindow l
        bindde = $mainMod Shift Control, right, Move active window to the right, exec, $moveactivewindow 30 0 || hyprctl dispatch movewindow r
        bindde = $mainMod Shift Control, up, Move active window up, exec, $moveactivewindow  0 -30 || hyprctl dispatch movewindow u
        bindde = $mainMod Shift Control, down, Move active window down, exec, $moveactivewindow 0 30 || hyprctl dispatch movewindow d

        $d=[$wm|Resize Active Window]
        bindde = $mainMod Shift, Right, $d resize window right , resizeactive, 30 0
        bindde = $mainMod Shift, Left, $d resize window left, resizeactive, -30 0
        bindde = $mainMod Shift, Up, $d resize window up, resizeactive, 0 -30
        bindde = $mainMod Shift, Down, $d resize  window down, resizeactive, 0 30

        $d=[$wm|Move & Resize with mouse]
        bindm = $mainMod, mouse:272, movewindow
        bindm = $mainMod, mouse:273, resizewindow


        $d=[$wm|Manage Float layout with Nuphy G1,G2,G3,G4]
        bind = , F21, exec, hyprctl --batch "dispatch tagwindow +left; dissatch setfloating; dispatch resizeactive exact 1474 1117; dispatch moveactive exact 5 34"
        bind = , F22, exec, hyprctl --batch "dispatch tagwindow +center; dispatch setfloating; dispatch resizeactive exact 1926 1112; dispatch moveactive exact 1486 34"
        bind = , F23, exec, hyprctl --batch "dispatch tagwindow +right; dispatch setfloating; dispatch resizeactive exact 672 1117; dispatch moveactive exact 3420 34"
        bind = , F24, exec, hyprctl -q dispatch togglegroup

    # }}}

    # Workspace {{{
        $ws=Workspaces
        $d=[$ws|Navigation]
        bindd = $mainMod, 1, $d navigate to workspace 1 , workspace, 1
        bindd = $mainMod, 2, $d navigate to workspace 2 , workspace, 2
        bindd = $mainMod, 3, $d navigate to workspace 3 , workspace, 3
        bindd = $mainMod, 4, $d navigate to workspace 4 , workspace, 4
        bindd = $mainMod, 5, $d navigate to workspace 5 , workspace, 5
        bindd = $mainMod, 6, $d navigate to workspace 6 , workspace, 6
        bindd = $mainMod, 7, $d navigate to workspace 7 , workspace, 7
        bindd = $mainMod, 8, $d navigate to workspace 8 , workspace, 8
        bindd = $mainMod, 9, $d navigate to workspace 9 , workspace, 9
        bindd = $mainMod, 0, $d navigate to workspace 10 , workspace, 10

        $d=[$ws|Navigation|Relative workspace]
        bindd = $mainMod Control, Right, $d change active workspace forwards  , workspace, r+1
        bindd = $mainMod Control, Left, $d change active workspace backwards , workspace, r-1

        $d=[$ws|Move window to workspace]
        bindd = $mainMod Alt, 1, $d move to workspace 1 , movetoworkspace, 1
        bindd = $mainMod Alt, 2, $d move to workspace 2 , movetoworkspace, 2
        bindd = $mainMod Alt, 3, $d move to workspace 3 , movetoworkspace, 3
        bindd = $mainMod Alt, 4, $d move to workspace 4 , movetoworkspace, 4
        bindd = $mainMod Alt, 5, $d move to workspace 5 , movetoworkspace, 5
        bindd = $mainMod Alt, 6, $d move to workspace 6 , movetoworkspace, 6
        bindd = $mainMod Alt, 7, $d move to workspace 7 , movetoworkspace, 7
        bindd = $mainMod Alt, 8, $d move to workspace 8 , movetoworkspace, 8
        bindd = $mainMod Alt, 9, $d move to workspace 9 , movetoworkspace, 9
        bindd = $mainMod Alt, 0, $d move to workspace 10 , movetoworkspace, 10

        $d=[$ws|Move window to workspace|Realtive workspace]
        bindd = $mainMod Control+Alt, Right, $d move window to next relative workspace , movetoworkspace, r+1
        bindd = $mainMod Control+Alt, Left, $d move window to previous relative workspace , movetoworkspace, r-1

        $d=[$ws|Navigation|Move window silently]
        bindd = $mainMod Shift, 1, $d move to workspace 1  (silent), movetoworkspacesilent, 1
        bindd = $mainMod Shift, 2, $d move to workspace 2  (silent), movetoworkspacesilent, 2
        bindd = $mainMod Shift, 3, $d move to workspace 3  (silent), movetoworkspacesilent, 3
        bindd = $mainMod Shift, 4, $d move to workspace 4  (silent), movetoworkspacesilent, 4
        bindd = $mainMod Shift, 5, $d move to workspace 5  (silent), movetoworkspacesilent, 5
        bindd = $mainMod Shift, 6, $d move to workspace 6  (silent), movetoworkspacesilent, 6
        bindd = $mainMod Shift, 7, $d move to workspace 7  (silent), movetoworkspacesilent, 7
        bindd = $mainMod Shift, 8, $d move to workspace 8  (silent), movetoworkspacesilent, 8
        bindd = $mainMod Shift, 9, $d move to workspace 9  (silent), movetoworkspacesilent, 9
        bindd = $mainMod Shift, 0, $d move to workspace 10 (silent), movetoworkspacesilent, 10

        # Scroll worspace with mouse
        # bindd = $mainMod, mouse_down, $d next workspace, workspace, e+1
        # bindd = $mainMod, mouse_up, $d previous workspace, workspace, e-1

    # }}}

    # Launcher Walker {{{
        $l=Launchers

        $d=[$l|Walker menus]
        bindd = $mainMod, Space, $d application finder , exec, $scrPath/launch-walker
        bindd = $mainMod ALT, Space, $d menu , exec, $scrPath/menu
        bindd = $mainMod, comma, $d emoji  picker , exec, $scrPath/launch-walker -m symbols
        bindd = $mainMod, Delete, $d logout menu, exec, $scrPath/menu system #logout menu
        bindd = $mainMod, slash, $d keybindings hint, exec, $scrPath/menu keybindings # launch keybinds hint
    # }}}

    # Hardware Control {{{
        $hc=Hardware Controls
        $d=[$hc|Audio]
        binddl  = , F10, $d toggle mute output , exec, $scrPath/volumecontrol -o m # toggle audio mute
        binddl  = , XF86AudioMute,$d  toggle mute output, exec, $scrPath/volumecontrol -o m # toggle audio mute
        binddel = , F11, $d decrease volume , exec, $scrPath/volumecontrol -o d # decrease volume
        binddel = , F12, $d increase volume , exec, $scrPath/volumecontrol -o i # increase volume
        binddl  = , XF86AudioMicMute,$d un/mute microphone  , exec, $scrPath/volumecontrol -i m # toggle microphone mute
        binddel = , XF86AudioLowerVolume, $d decrease volume , exec, $scrPath/volumecontrol -o d # decrease volume
        binddel = , XF86AudioRaiseVolume, $d increase volume , exec, $scrPath/volumecontrol -o i # increase volume

        $d=[$hc|Media]
        binddl  = , XF86AudioPlay,$d play media, exec, playerctl play-pause # toggle between media play and pause
        binddl  = , XF86AudioPause,$d pause media, exec, playerctl play-pause # toggle between media play and pause
        binddl  = , XF86AudioNext,$d next media  , exec, playerctl next # media next
        binddl  = , XF86AudioPrev,$d  previous media , exec, playerctl previous # media previous

        $d=[$hc|Brightness]
        binddel = , XF86MonBrightnessUp, $d increase brightness , exec, $scrPath/brightnesscontrol.sh i # increase brightness
        binddel = , XF86MonBrightnessDown, $d decrease brightness , exec, $scrPath/brightnesscontrol.sh d # decrease brightness
    # }}}

    # Utilities {{{
        $ut=Utilities
        $d=[$ut]
        bindd = $mainMod, L, $d lock screen, exec, lockscreen.sh # lockcreen
        # bindd = Control Alt, Delete, $d logout menu, exec, $scrPath/logoutlaunch.sh # logout menu
        # binddl = $mainMod, K, $d toggle keyboardlayout , exec, $scrPath/keyboardswitch.sh # switch keyboard layout
        bindd = $mainMod Alt, G, $d game mode , exec, $scrPath/gamemode.sh # disable hypr effects for gamemode
        bindd = $mainMod, mouse_up, $d zooom out, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor | awk '/^float.*/ {print $2 * 0.5}')
        bindd = $mainMod, mouse_down, $d zoom in, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor | awk '/^float.*/ {print $2 * 1.8}')
    # }}}

    # Capture {{{
        $cap=Capture
        $d=[$cap|Screenshot]
        bindd = $mainMod, P, $d Enter Screenshot Mode, submap, screenshot

        submap = screenshot, reset
        # Inside submap screenshot
        bindde = , a, $d Area (Save Direct), exec, $scrPath/cmd-screenshot sn   # partial screenshot capture
        bindde = , e, $d Area (Edit), exec, $scrPath/cmd-screenshot sf          # partial screenshot capture and edit
        bindde = , m, $d Current Monitor, exec, $scrPath/cmd-screenshot m       # monitor screenshot
        bindde = , p, $d All Monitors, exec, $scrPath/cmd-screenshot p          # all monitor screenshot
        bindde = , o, $d OCR to Clipboard, exec, $scrPath/cmd-screenshot sc     # ocr screenshot to clipboard

        bind = , escape, submap, reset
        bind = , return, submap, reset

        # Come back global mode
        submap = reset

        $d=[$cap|Color]
        bindd = $mainMod , C, $d picker, exec, hyprpicker -an # Pick color (Hex) >> clipboard#
        bindd = $mainMod Shift, C, $d picker change, exec, color_picker.sh   # Pick color (Hex) >> oklch-color-picker
    # }}}

    # Ricing {{{
        $rice=Theming and Wallpaper
        $d=[$rice]
        # TODO: Vedere quali di questi lasciare
        bindd = $mainMod Shift, W, $d next wallpaper , exec, $scrPath/theme-bg-next # next global wallpaper
        # bindd = $mainMod Alt, Left, $d previous global wallpaper , exec, $scrPath/wallpaper.sh -Gp # previous global wallpaper
        # bindd = $mainMod Shift, W, $d select a global wallpaper , exec, pkill -x rofi || $scrPath/wallpaper.sh -SG # launch wallpaper select menu
        # bindd = $mainMod Alt, Up, $d next waybar layout , exec, $scrPath/wbarconfgen.sh n # next waybar mode
        # bindd = $mainMod Alt, Down, $d previous waybar layout , exec, $scrPath/wbarconfgen.sh p # previous waybar mode
        # bindd = $mainMod Shift, R, $d wallbash mode selector , exec, pkill -x rofi || $scrPath/wallbashtoggle.sh -m # launch wallbash mode select menu
        # bindd = $mainMod Shift, T, $d select a theme, exec, pkill -x rofi || $scrPath/themeselect.sh # launch theme select menu
        # bindd = $mainMod+Shift, Y, $d select animations, exec, pkill -x rofi || $scrPath/animations.sh --select # launch animations select menu
        # bindd = $mainMod+Shift, U, $d select hyprlock layout, exec, pkill -x rofi || $scrPath/hyprlock.sh --select # launch hyprlock layout select menu
        bindd = $mainMod Alt, T, $d toggle waybar, exec, killall waybar || app2unit.sh -t service waybar # restart waybar
    # }}}

    # Speacial APP {{{
        bind = Ctrl, mouse:274, global, :application-menu
        bindr = $mainMod, mouse:274, global, :hyrpland-menu
        bind = ALT, Space, exec, hypr-gridtile
    # }}}

    $d=#! unset the group name

# }}}

# WINDOW RULES {{{

    # This symbol indicates that the following values will override the default configuration, override other group rules
    $ovr=override
    $active = 0.94
    $inactive = 0.82

    # FIX {{{
        windowrule {
            name = suppress-maximize-all
            match:class = .*

            suppress_event = maximize
        }

        windowrule {
            name = xwayland-drag-fix-nofocus
            match:class = ^$
            match:title = ^$
            match:xwayland = on
            match:float = on
            match:fullscreen = off
            match:pin = off

            no_focus = on
        }
    # }}}

    # Float Layout {{{
        windowrule {
            name = ws1-base
            match:workspace = 1
            float = on
            center = on
        }

        windowrule {
            name = ws1-tag-left
            match:workspace = 1
            match:class = ^(vivaldi-stable)$
            tag = +left
        }

        windowrule {
            name = ws1-tag-center
            match:workspace = 1
            match:class = ^(mousepad|kitty-nvim|sublime_text|obsidian|kitty|Alacritty)$
            tag = +center
        }

        windowrule {
            name = ws1-tag-right-dolphin
            match:class = ^(org.kde.dolphin)$
            match:title = negative:^(.*(Configura|Copia|file esiste|Proprietà|Conferma|Sostituisci|Progress|About|Informazioni|Sposta|etichette|avanzamento).*)$

            tag = +right
        }

        windowrule {
            name = ws1-tag-right-krusader
            match:class = ^(org.kde.krusader)$
            match:initial_title = ^(Krusader)$

            tag = +right
        }

        windowrule {
            name = ws1-left
            match:tag = left

            animation = popin
            size = (monitor_w*0.36) (monitor_h-38)
            move = (5) (34)
        }

        windowrule {
            name = ws1-center
            match:tag = center

            animation = popin
            size = (monitor_w*0.47) (monitor_h-38)
            move = ((monitor_w*0.36)+10) (34)
        }

        windowrule {
            name = ws1-right
            match:tag = right

            animation = popin
            size = (monitor_w*0.164) (monitor_h-38)
            move = ((monitor_w*0.83)+18) (34)
        }
    # }}}

    # Idleinhibit rules {{{
        windowrule {
            name = idleinhibit-fullscreen-media-browsers
            match:class = ^.*(celluloid|mpv|vlc|[Ss]potify|LibreWolf|floorp|brave|firefox|chromium|zen|vivaldi).*$

            idle_inhibit = fullscreen
        }
    # }}}

    # Picture-in-Picture {{{
        windowrule {
            name = pip-float-pin
            match:title = ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$

            float = on
            keep_aspect_ratio = on
            move = ((monitor_w*0.73)) ((monitor_h*0.72))
            size = (monitor_w*0.25)
            pin = on
        }
    # }}}

    # Dialog {{{
        windowrule {
            name = dolphin-dialog-generic
            match:class = ^(org.kde.dolphin)$
            match:title = ^(.*(Configura|Sposta|Proprietà|Conferma|Sostituisci|Elimina|Informazioni|Progress|About|etichette).*)$

            float = on
            animation = popin
            center = on
            dim_around = on
        }

        windowrule {
            name = dolphin-copy-progress
            match:class = ^(org.kde.dolphin|org.kde.krusader)$
            match:title = ^(Copia in corso — Dolphin|Finestra di avanzamento — Dolphin)$

            move = (1860) (248)
            size = 600 178
            animation = popin
        }

        windowrule {
            name = dolphin-file-exists
            match:class = ^(org.kde.dolphin)$
            match:title = ^(Il file esiste già — Dolphin)$

            move = (1860) (434)
            size = 600 283
            animation = popin
            dim_around = on
        }

        windowrule {
            name = krusader-config
            match:class = ^(org.kde.krusader)$
            match:title = ^(.+Krusader)$

            size = (monitor_w*0.3) (monitor_h*0.6)
            center = on
            animation = popin
            dim_around = on
        }

        windowrule {
            name = krusader-copy-progress
            match:class = ^(org.kde.krusader)$
            match:title = ^(Copia in corso — Krusader|Finestra di avanzamento — Krusader)$

            move = (1860) (248)
            size = 600 178
            animation = popin
            dim_around = off
        }

        windowrule {
            name = krusader-file-exists
            match:class = ^(org.kde.krusader)$
            match:title = ^(Il file esiste già — Krusader)$

            move = (1860) (434)
            size = 600 283
            animation = popin
            dim_around = on
        }


        windowrule {
            name = systry-float
            match:class = (org.pulseaudio.pavucontrol|syncthingtray-qt6|blueman-manager|nm-applet)

            float = on
            pin = on
            size = 800 600
            move = (monitor_w-window_w-10) 36
        }


        windowrule {
            name = float-modals
            match:modal = on

            float = on
            focus_on_activate = on
        }

        windowrule {
            name = firefox-floats
            match:class = ^firefox$
            match:title = ^(About Mozilla Firefox|Picture-in-Picture|Library)$

            float = on
        }


        windowrule {
            name = float-dialog-title
            match:title = ^(.*dialog.*)$

            float = on
        }

        windowrule {
            name = portal-gtk-open-save
            match:class = ^(xdg-desktop-portal-gtk)$

            float = on
            size = 1200 800
            center = on
            dim_around = on
        }

        windowrule {
            name = float-prefix-titles
            match:title = ^(File Upload|Choose wallpaper|Library).*$

            float = on
        }

        windowrule {
            name = float-polkit
            match:class = ^(polkit-gnome-authentication-agent.*)

            focus_on_activate = on
            pin = on
            stay_focused = on
            dim_around = on,
        }
    # }}}

    # Opacity {{{
        $&=override
        $active = 0.94
        $inactive = 0.82

        windowrule {
            name = opacity-browser
            match:class = (?i)^(vivaldi-stable|zen-beta|brave-browser|firefox|google-chrome|chromium|librewolf|floorp|org.qutebrowser.qutebrowser)

            opacity = 1 $ovr 1 $ovr 1
        }

        windowrule {
            name = opacity-kitty
            match:class = ^(.*kitty.*)$
            opacity = 0.95 $ovr 0.85 $ovr
        }
    # }}}

    # Float {{{
        windowrule {
            name = qview-float
            match:class = (com.interversehq.qView)

            float = on
            center = on
            size = (monitor_w*0.28) (monitor_h*0.54)
            min_size = 600 420
            max_size = 2600 1420
            focus_on_activate = on
            dim_around = on,
        }

        windowrule {
            name = sysd-manager-float-opacity
            match:class = ^(io.github.plrigaux.sysd-manager)$
            match:title = ^(sysd-manager)$

            float = on
            size = (monitor_w*0.58) (monitor_h*0.84)
            focus_on_activate = on
            dim_around = on,
        }

        windowrule {
            name = kitty-btop-size
            match:class = ^(kitty-btop)$

            size = (monitor_w*0.58) (monitor_h*0.84)
            center = on
            float = on
            focus_on_activate = on
            dim_around = on,
        }
        
        windowrule {
            name = theme-manager-float
            match:class = ^(kvantummanager|qt5ct|qt6ct|nwg-look)$

            float = on
            size = (monitor_w*0.34) (monitor_h*0.74)
            focus_on_activate = on
            dim_around = on,
        }

        windowrule {
            name = floating-window-behavior
            match:class = (TUI.float)

            float = on
            center = on
            size = (monitor_w*0.28) (monitor_h*0.84)
            focus_on_activate = on
            dim_around = on,
        }

        windowrule {
            name = hyprarch-editors-float-center
            match:class = ^(org.hyprarch.(nvim|vim|nano|micro|hx|helix))$

            float = on
            center = on
            size = (monitor_w*0.58) (monitor_h*0.84)
            focus_on_activate = on
            dim_around = on,
        }


    # }}}

    # Style {{{
        $active = rgba(78c6ebff)
        $inactive = rgba(d0877090)
        windowrule = border_color $active $inactive, match:tag pinned
    # }}}

    # Full Screen {{{
        windowrule {
            name = hyprarch-screensaver-fullscreen
            match:class = ^org\.hyprarch\.screensaver$

            fullscreen = on
        }
    # }}}

    # Application {{{
        windowrule {
            name = Oklch_Color_Picker
            match:title = ^(.*Oklch Color Picker.*)$

            float = on
            animation = popin
            group = barred
            center = on
            size= (monitor_w*0.15) (monitor_h*0.45)
        }

        windowrule {
            name         = Hypr_gridtile
            match:class  = ^(glfw window)$

            no_anim = on
            stay_focused = on
            group = barred
            border_size = 1
        }

        windowrule {
            name = Vivaldi
            match:class = ^(.*vivaldi.*)$

            group = barred
        }

        windowrule {
            name = Pacsea
            match:class = ^(.*kitty-pacsea.*)$

            group = barred
            size = (monitor_w*0.58) (monitor_h*0.84)
            focus_on_activate = on
            center = on
            float = on
        }

        windowrule {
            name = Dolphin
            match:class = ^(org.kde.dolphin)$

            group = barred
        }

        windowrule {
            name = Krusader
            match:class = ^(org.kde.krusader)$

            group = barred
        }

        windowrule {
            name = kando-overlay
            match:class = ^(kando)$

            no_blur = on
            opaque = on
            size = (monitor_w*1) (monitor_h*1)

            border_size = on
            no_anim = on
            float = on
            pin = on
        }
    # }}}

# }}}

# LAYER RULES {{{
    layerrule = blur on, ignore_alpha 0, match:namespace rofi
    layerrule = blur on, ignore_alpha 0, match:namespace notifications
    layerrule = blur on, ignore_alpha 0, match:namespace swaync-notification-window
    layerrule = blur on, ignore_alpha 0, match:namespace swaync-control-center
    layerrule = blur on, match:namespace logout_dialog
    layerrule = ignore_alpha 0, blur on, xray 0, blur_popups on, match:namespace cairo-dock
# }}}

